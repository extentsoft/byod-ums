<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">

    <title><%= title %></title>

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js"></script>
		<script>
          WebFont.load({
            google: {"families":["Poppins:300,400,500,600,700","Roboto:300,400,500,600,700"]},
            active: function() {
                sessionStorage.fonts = true;
            }
          });
		</script>
		<!--end::Web font -->
        <!--begin::Base Styles -->
        <!--begin::Page Vendors -->
		<link href="../assets/vendors/custom/fullcalendar/fullcalendar.bundle.css" rel="stylesheet" type="text/css" />
		<!--end::Page Vendors -->
		<link href="../assets/vendors/base/vendors.bundle.css" rel="stylesheet" type="text/css" />
		<link href="../assets/demo/demo5/base/style.bundle.css" rel="stylesheet" type="text/css" />
		<!--end::Base Styles -->
		<link rel="shortcut icon" href="../assets/demo/demo5/media/img/logo/favicon.ico" />
  </head>
  <body class="m-page--wide m-header--fixed m-header--fixed-mobile m-footer--push m-aside--offcanvas-default"  >
    <!-- begin:: Page -->
		<div class="m-grid m-grid--hor m-grid--root m-page">
			<!-- begin::Header -->
      <!-- begin::Header -->
			<header class="m-grid__item		m-header "  data-minimize="minimize" data-minimize-offset="200" data-minimize-mobile-offset="200" >
				<div class="m-header__top">
					<div class="m-container m-container--responsive m-container--xxl m-container--full-height m-page__container">
						<div class="m-stack m-stack--ver m-stack--desktop">
							<!-- begin::Brand -->
							<div class="m-stack__item m-brand">
								<div class="m-stack m-stack--ver m-stack--general m-stack--inline">
									<div class="m-stack__item m-stack__item--middle m-brand__logo">
										<a href="/admin/" class="m-brand__logo-wrapper">
											<img width="90px" height="90px" alt="" src="../assets/demo/demo5/media/img/logo/logo.png"/>
										</a>
									</div>

								</div>
							</div>
							<!-- end::Brand -->
				<!-- begin::Topbar -->
							<div class="m-stack__item m-stack__item--fluid m-header-head" id="m_header_nav">
								<div id="m_header_topbar" class="m-topbar  m-stack m-stack--ver m-stack--general">
									<div class="m-stack__item m-topbar__nav-wrapper">
										<ul class="m-topbar__nav m-nav m-nav--inline">


											<li class="m-nav__item m-topbar__user-profile m-topbar__user-profile--img  m-dropdown m-dropdown--medium m-dropdown--arrow m-dropdown--header-bg-fill m-dropdown--align-right m-dropdown--mobile-full-width m-dropdown--skin-light" data-dropdown-toggle="click">
												<a href="#" class="m-nav__link m-dropdown__toggle">
													<span class="m-topbar__welcome">
														Hello,&nbsp;
													</span>
													<span class="m-topbar__username">
														<%= user_id %>
													</span>
													<span class="m-topbar__userpic">
														<img src="../assets/app/media/img/users/user4.jpg" class="m--img-rounded m--marginless m--img-centered" alt=""/>
													</span>
												</a>
												<div class="m-dropdown__wrapper">
													<span class="m-dropdown__arrow m-dropdown__arrow--right m-dropdown__arrow--adjust"></span>
													<div class="m-dropdown__inner">
														<div class="m-dropdown__header m--align-center" style="background: url(../assets/app/media/img/misc/user_profile_bg.jpg); background-size: cover;">
															<div class="m-card-user m-card-user--skin-dark">
																<div class="m-card-user__pic">
																	<img src="../assets/app/media/img/users/user4.jpg" class="m--img-rounded m--marginless" alt=""/>
																</div>
																<div class="m-card-user__details">
																	<span class="m-card-user__name m--font-weight-500">
																		<%= user_cn %>
																	</span>
																	<a href="" class="m-card-user__email m--font-weight-300 m-link">
																		<%= user_id %>@excise.go.th
																	</a>
																</div>
															</div>
														</div>
														<div class="m-dropdown__body">
															<div class="m-dropdown__content">
																<ul class="m-nav m-nav--skin-light">
																	<li class="m-nav__item">
																		<a href="/admin/logout" class="btn m-btn--pill btn-secondary m-btn m-btn--custom m-btn--label-brand m-btn--bolder">
																			Logout
																		</a>
																	</li>
																</ul>
															</div>
														</div>
													</div>
												</div>
											</li>

										</ul>
									</div>
								</div>
							</div>
							<!-- end::Topbar -->
						</div>
					</div>
				</div>
				<div class="m-header__bottom">
					<div class="m-container m-container--responsive m-container--xxl m-container--full-height m-page__container">
						<div class="m-stack m-stack--ver m-stack--desktop">
							<!-- begin::Horizontal Menu -->
							<div class="m-stack__item m-stack__item--middle m-stack__item--fluid">
								<button class="m-aside-header-menu-mobile-close  m-aside-header-menu-mobile-close--skin-light " id="m_aside_header_menu_mobile_close_btn">
									<i class="la la-close"></i>
								</button>
								<div id="m_header_menu" class="m-header-menu m-aside-header-menu-mobile m-aside-header-menu-mobile--offcanvas  m-header-menu--skin-dark m-header-menu--submenu-skin-light m-aside-header-menu-mobile--skin-light m-aside-header-menu-mobile--submenu-skin-light "  >
									<ul class="m-menu__nav  m-menu__nav--submenu-arrow ">
										<li class="m-menu__item  m-menu__item--active"  aria-haspopup="true">
											<a  href="/admin/" class="m-menu__link ">
												<span class="m-menu__item-here"></span>
												<span class="m-menu__link-text">
													Dashboard
												</span>
											</a>
										</li>
										<li class="m-menu__item  m-menu__item--active"  aria-haspopup="true">
											<a  href="/admin/user" class="m-menu__link m-menu__toggle">
												<span class="m-menu__link-text">
													Users
												</span>
											</a>
										</li>
										<li class="m-menu__item  m-menu__item--active"  aria-haspopup="true">
											<a  href="/admin/device" class="m-menu__link m-menu__toggle">
												<span class="m-menu__link-text">
													Devices
												</span>
											</a>
										</li>
                    <li class="m-menu__item  m-menu__item--active"  aria-haspopup="true">
											<a href="/admin/configuration" class="m-menu__link m-menu__toggle">
												<span class="m-menu__link-text">
													Configurations
												</span>
											</a>
										</li>
                    <li class="m-menu__item  m-menu__item--active"  aria-haspopup="true">
											<a href="/admin/message" class="m-menu__link m-menu__toggle">
												<span class="m-menu__link-text">
													Messages
												</span>
											</a>
										</li>
										<li class="m-menu__item  m-menu__item--submenu"  data-menu-submenu-toggle="click" data-redirect="true" aria-haspopup="true">
											<a  href="#" class="m-menu__link m-menu__toggle">
												<span class="m-menu__item-here"></span>
												<span class="m-menu__link-text">
													Reports
												</span>
												<i class="m-menu__hor-arrow la la-angle-down"></i>
												<i class="m-menu__ver-arrow la la-angle-right"></i>
											</a>
											<div class="m-menu__submenu  m-menu__submenu--fixed-xl m-menu__submenu--center" >
												<span class="m-menu__arrow m-menu__arrow--adjust"></span>
												<div class="m-menu__subnav">
													<ul class="m-menu__content">
														<li class="m-menu__item">
															<h3 class="m-menu__heading m-menu__toggle">
																<span class="m-menu__link-text">
																	Policy Violation Reports
																</span>
																<i class="m-menu__ver-arrow la la-angle-right"></i>
															</h3>
															<ul class="m-menu__inner">
																<li class="m-menu__item "  data-redirect="true" aria-haspopup="true">
																	<a  href="/admin/report/rpt11" class="m-menu__link ">
																		<i class="m-menu__link-icon flaticon-map"></i>
																		<span class="m-menu__link-text">
																			Login บ่อยมากกว่าครั้งที่กำหนด
																		</span>
																	</a>
																</li>
																<li class="m-menu__item "  data-redirect="true" aria-haspopup="true">
																	<a  href="/admin/report/rpt12" class="m-menu__link ">
																		<i class="m-menu__link-icon flaticon-user"></i>
																		<span class="m-menu__link-text">
																			เพิ่ม/ลบ อุปกรณ์มากเกินกว่าที่กำหนด
																		</span>
																	</a>
																</li>
                                <li class="m-menu__item "  data-redirect="true" aria-haspopup="true">
																	<a  href="/admin/report/rpt13" class="m-menu__link ">
																		<i class="m-menu__link-icon flaticon-graphic-1"></i>
																		<span class="m-menu__link-text">
																			ปรับปรุงข้อมูลส่วนตัวมากกว่าจำนวนที่กำหนด
																		</span>
																	</a>
																</li>
																<li class="m-menu__item "  data-redirect="true" aria-haspopup="true">
																	<a  href="/admin/report/rpt14" class="m-menu__link ">
																		<i class="m-menu__link-icon flaticon-clipboard"></i>
																		<span class="m-menu__link-text">
																			Login ต่างสถานที่ภายในระยะเวลาที่กำหนด
																		</span>
																	</a>
																</li>
																<li class="m-menu__item "  data-redirect="true" aria-haspopup="true">
																	<a  href="/admin/report/rpt15" class="m-menu__link ">
																		<i class="m-menu__link-icon flaticon-graphic-2"></i>
																		<span class="m-menu__link-text">
																			บุคคลากรที่ลงทะเบียนอุปกรณ์ครบตามจำนวนที่กำหนด
																		</span>
																	</a>
																</li>
															</ul>
														</li>
														<li class="m-menu__item">
															<h3 class="m-menu__heading m-menu__toggle">
																<span class="m-menu__link-text">
																	รายงานอื่นๆ
																</span>
																<i class="m-menu__ver-arrow la la-angle-right"></i>
															</h3>
															<ul class="m-menu__inner">
																<li class="m-menu__item "  data-redirect="true" aria-haspopup="true">
																	<a  href="/admin/report/rpt21" class="m-menu__link ">
																		<i class="m-menu__link-bullet m-menu__link-bullet--line">
																			<span></span>
																		</i>
																		<span class="m-menu__link-text">
																			รายงานที่ 1
																		</span>
																	</a>
																</li>
																<li class="m-menu__item "  data-redirect="true" aria-haspopup="true">
																	<a  href="/admin/report/rpt22" class="m-menu__link ">
																		<i class="m-menu__link-bullet m-menu__link-bullet--line">
																			<span></span>
																		</i>
																		<span class="m-menu__link-text">
																			รายงานที่ 2
																		</span>
																	</a>
																</li>
																<li class="m-menu__item "  data-redirect="true" aria-haspopup="true">
																	<a  href="/admin/report/rpt23" class="m-menu__link ">
																		<i class="m-menu__link-bullet m-menu__link-bullet--line">
																			<span></span>
																		</i>
																		<span class="m-menu__link-text">
																			รายงานที่ 3
																		</span>
																	</a>
																</li>
																<li class="m-menu__item "  data-redirect="true" aria-haspopup="true">
																	<a  href="/admin/report/rpt24" class="m-menu__link ">
																		<i class="m-menu__link-bullet m-menu__link-bullet--line">
																			<span></span>
																		</i>
																		<span class="m-menu__link-text">
																			รายงานที่ 4
																		</span>
																	</a>
																</li>
																<li class="m-menu__item "  data-redirect="true" aria-haspopup="true">
																	<a  href="/admin/report/rpt25" class="m-menu__link ">
																		<i class="m-menu__link-bullet m-menu__link-bullet--line">
																			<span></span>
																		</i>
																		<span class="m-menu__link-text">
																			รายงานที่ 5
																		</span>
																	</a>
																</li>
																<li class="m-menu__item "  data-redirect="true" aria-haspopup="true">
																	<a  href="/admin/report/rpt26" class="m-menu__link ">
																		<i class="m-menu__link-bullet m-menu__link-bullet--line">
																			<span></span>
																		</i>
																		<span class="m-menu__link-text">
																			รายงานที่ 6
																		</span>
																	</a>
																</li>
															</ul>
														</li>
													</ul>
												</div>
											</div>
										</li>

									</ul>
								</div>
							</div>
							<!-- end::Horizontal Menu -->


						</div>
					</div>
				</div>
			</header>
			<!-- end::Header -->
		<!-- begin::Body -->
			<div class="m-grid__item m-grid__item--fluid m-grid m-grid--hor-desktop m-grid--desktop m-body">
				<div class="m-grid__item m-grid__item--fluid  m-grid m-grid--ver	m-container m-container--responsive m-container--xxl m-page__container">
					<div class="m-grid__item m-grid__item--fluid m-wrapper">
						<!-- BEGIN: Subheader -->
						<div class="m-subheader ">
							<div class="d-flex align-items-center">
								<div class="mr-auto">
									<h3 class="m-subheader__title ">
										Suspicious distant access
									</h3>
								</div>
								<div>
									<span class="m-subheader__daterange" id="m_dashboard_daterangepicker">
										<span class="m-subheader__daterange-label">
											<span class="m-subheader__daterange-title"></span>
											<span class="m-subheader__daterange-date m--font-brand"></span>
										</span>
										<a href="#" class="btn btn-sm btn-brand m-btn m-btn--icon m-btn--icon-only m-btn--custom m-btn--pill">
											<i class="la la-angle-down"></i>
										</a>
									</span>
								</div>
							</div>
						</div>
						<!-- END: Subheader -->
						<div class="m-content">
							<!--Begin::Main Portlet-->
							<div class="m-portlet">
								<div class="m-portlet__body  m-portlet__body--no-padding">
									<div class="row m-row--no-padding m-row--col-separator-xl">

										<div class="container">
										<table id="jqGrid"></table>
											<div id="jqGridPager"></div>
											<div class="contextMenu" id="contextMenu" style="display:none; width:400px;">
												<ul style="width: 400px; font-size: 65%;">
												 <!--   <li id="add">
														<span class="ui-icon ui-icon-plus" style="float:left"></span>
														<span style="font-size:130%; font-family:Verdana">Add Row</span>
													</li>  -->
													<li id="edit">
														<span class="ui-icon ui-icon-pencil" style="float:left"></span>
														<span style="font-size:130%; font-family:Verdana">Edit</span>
													</li>
													<li id="del">
														<span class="ui-icon ui-icon-trash" style="float:left"></span>
														<span style="font-size:130%; font-family:Verdana">Delete</span>
													</li>
												</ul>
											</div>

										</div>
									  </div>
										</div>
									</div>
								</div>
							</div>
							<!--End::Main Portlet-->

								</div>
							</div>

						</div>
					</div>
				</div>
			</div>
			<!-- end::Body -->
<!-- begin::Footer -->
			<footer class="m-grid__item m-footer ">
				<div class="m-container m-container--responsive m-container--xxl m-container--full-height m-page__container">
					<div class="m-footer__wrapper">
						<div class="m-stack m-stack--flex-tablet-and-mobile m-stack--ver m-stack--desktop">
							<div class="m-stack__item m-stack__item--left m-stack__item--middle m-stack__item--last">
								<span class="m-footer__copyright">
									2017 &copy;
									<a href="#" class="m-link">

									</a>
								</span>
							</div>
							<div class="m-stack__item m-stack__item--right m-stack__item--middle m-stack__item--first">
								<ul class="m-footer__nav m-nav m-nav--inline m--pull-right">
									<li class="m-nav__item">
										<a href="#" class="m-nav__link">
											<span class="m-nav__link-text">
												About
											</span>
										</a>
									</li>
									<li class="m-nav__item">
										<a href="#"  class="m-nav__link">
											<span class="m-nav__link-text">
												Privacy
											</span>
										</a>
									</li>
									<li class="m-nav__item">
										<a href="#" class="m-nav__link">
											<span class="m-nav__link-text">
												T&C
											</span>
										</a>
									</li>
									<li class="m-nav__item">
										<a href="#" class="m-nav__link">
											<span class="m-nav__link-text">
												Purchase
											</span>
										</a>
									</li>
									<li class="m-nav__item m-nav__item--last">
										<a href="#" class="m-nav__link" data-toggle="m-tooltip" title="Support Center" data-placement="left">
											<i class="m-nav__link-icon flaticon-info m--icon-font-size-lg3"></i>
										</a>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</footer>
			<!-- end::Footer -->
		</div>	            <!-- begin::Quick Sidebar -->

		<div class="m-scroll-top m-scroll-top--skin-top" data-toggle="m-scroll-top" data-scroll-offset="500" data-scroll-speed="300">
			<i class="la la-arrow-up"></i>
		</div>
		<!-- end::Scroll Top -->			<!-- begin::Quick Nav -->
		<ul class="m-nav-sticky" style="margin-top: 30px;">
			<!--
			<li class="m-nav-sticky__item" data-toggle="m-tooltip" title="Showcase" data-placement="left">
				<a href="">
					<i class="la la-eye"></i>
				</a>
			</li>
			<li class="m-nav-sticky__item" data-toggle="m-tooltip" title="Pre-sale Chat" data-placement="left">
				<a href="" >
					<i class="la la-comments-o"></i>
				</a>
			</li>
			-->
			<li class="m-nav-sticky__item" data-toggle="m-tooltip" title="Purchase" data-placement="left">
				<a href="https://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes" target="_blank">
					<i class="la la-cart-arrow-down"></i>
				</a>
			</li>
			<li class="m-nav-sticky__item" data-toggle="m-tooltip" title="Documentation" data-placement="left">
				<a href="http://keenthemes.com/metronic/documentation.html" target="_blank">
					<i class="la la-code-fork"></i>
				</a>
			</li>
			<li class="m-nav-sticky__item" data-toggle="m-tooltip" title="Support" data-placement="left">
				<a href="http://keenthemes.com/forums/forum/support/metronic5/" target="_blank">
					<i class="la la-life-ring"></i>
				</a>
			</li>
		</ul>



    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!--begin::Base Scripts -->
		<script src="../assets/vendors/base/vendors.bundle.js" type="text/javascript"></script>
		<script src="../assets/demo/demo5/base/scripts.bundle.js" type="text/javascript"></script>
		<!--end::Base Scripts -->
        <!--begin::Page Vendors -->
		<script src="../assets/vendors/custom/fullcalendar/fullcalendar.bundle.js" type="text/javascript"></script>
		<!--end::Page Vendors -->
        <!--begin::Page Snippets -->
		<script src="../assets/app/js/dashboard.js" type="text/javascript"></script>
		<!--end::Page Snippets -->
		<script>window.jQuery || document.write('<script src="https://v4-alpha.getbootstrap.com/assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://v4-alpha.getbootstrap.com/assets/js/vendor/holder.min.js"></script>


	<script src="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.10.4/jquery-ui.min.js" type="text/javascript"></script>

    <!-- We support more than 40 localizations -->

    <script type="text/ecmascript" src="javascripts/js/i18n/grid.locale-en.js"></script>
	<script type="text/ecmascript" src="http://www.guriddo.net/demo/js/context-menu.js"></script>

    <!-- This is the Javascript file of jqGrid -->

    <script type="text/ecmascript" src="javascripts/js/jquery.jqGrid.min.js"></script>

    <!-- This is the localization file of the grid controlling messages, labels, etc.
	<!-- A link to a jQuery UI ThemeRoller theme, more than 22 built-in and many more custom -->

	<link rel="stylesheet" type="text/css" href="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.11.1/themes/black-tie/jquery-ui.css" />

    <!-- The link to the CSS that the grid needs -->

    <link rel="stylesheet" type="text/css" media="screen" href="javascripts/css/ui.jqgrid.css" />

    <script>
	//alert('a');
	function devicelist(){
		$.ajax('http://localhost:3000/alldevices', {
		type: "get",
        success: function(json) {
			//alert(json);
			//alert(JSON.stringify(json));
			data_res = JSON.parse(JSON.stringify(json));
			mkdata(data_res);
        },
		error: function(fa) {alert(JSON.stringify(fa));}
      });
	}

	function mkdata(data_sql){
		//alert(data_sql);
		data = [];
		for (i = 0; i < data_sql.length; i++) {
			data_json = {};
			data_json = {terid:data_sql[0],terusr:data_sql[1],tername:data_sql[2],termac:data_sql[3],teros:data_sql[4],update:data_sql[5],regist:data_sql[6]};
			//alert(JSON.stringify(data_json));
			data.push(data_json);
			//alert(JSON.stringify(data));
			data_sql.splice(0,7);
			i = -1;
		}
		//alert(JSON.stringify(data));
		gengrid(data);
	}


      function gengrid(mydata) {
	  //alert(JSON.stringify(mydata));
            $("#jqGrid").jqGrid({
				editurl: 'clientArray',
                datatype: "local",
				data: mydata,
                colModel: [
					{ label: 'ID', name: 'terid', width: 150, key:true, editrules : { required: true}},
                    { label: 'Username', name: 'terusr', width: 200, editable: true },
                    { label: 'Devicename', name: 'tername', width: 90, editable: true },
					{ label: 'MAC', name: 'termac', width: 150, editable: true },
					{ label: 'OS', name: 'teros', width: 90, editable: true },
					{ label: 'Last Update', name: 'update', width: 250, editable: true },
                    { label: 'Register Date', name: 'regist', width: 250, editable: true }
                ],
                viewrecords: true,


                pager: "#jqGridPager",
				gridComplete: initGrid
            });
    }

	function initGrid() {
	//alert('init');
            $(".jqgrow", "#jqGrid").contextMenu('contextMenu', {
                bindings: {
                    'edit': function (t) {
                        editRow();
                    },
                    /*'add': function (t) {
                        addRow();
                    },*/
                    'del': function (t) {
                        delRow();
                    }
                },
                onContextMenu: function (event, menu) {
                    var rowId = $(event.target).parent("tr").attr("id")
                    var grid = $("#jqGrid");
                    grid.setSelection(rowId);

                    return true;
                }
            });

           /* function addRow() {
                var grid = $("#jqGrid");
                grid.editGridRow("new", { closeAfterAdd: true});
            }*/

            function editRow() {
                var grid = $("#jqGrid");
                var rowKey = grid.getGridParam("selrow");
                if (rowKey) {
                    grid.editGridRow(rowKey, {closeAfterEdit: true});
                }
                else {
                    alert("No rows are selected");
                }
            }

            function delRow() {
                var grid = $("#jqGrid");
                var rowKey = grid.getGridParam("selrow");
                if (rowKey) {
                    grid.delGridRow(rowKey);
                }
                else {
                    alert("No rows are selected");
                }
            }
        }



 //alert('b');
 devicelist();
   </script>
  </body>
</html>
